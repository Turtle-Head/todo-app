var app=app||{};(function(a){app.TodoView=Backbone.View.extend({tagName:"li",template:_.template(a("#item-template").html()),events:{"click .toggle":"toggleCompleted","dblclick label":"edit","click .destroy":"clear","keypress .edit":"updateOnEnter","keydown .edit":"revertOnEscape","blur .edit":"close","click .edit-btn":"edit","click .priority-btn":"togglePriority"},initialize:function(){this.listenTo(this.model,"change",this.render);this.listenTo(this.model,"destroy",this.remove);this.listenTo(this.model,"visible",this.toggleVisible)},render:function(){if(this.model.changed.id!==undefined){return}this.$el.html(this.template(this.model.toJSON()));this.$el.toggleClass("completed",this.model.get("completed"));this.$el.toggleClass("priority",this.model.get("priority"));this.toggleVisible();this.$input=this.$(".edit");return this},toggleVisible:function(){this.$el.toggleClass("hidden",this.isHidden())},isHidden:function(){return this.model.get("completed")?app.TodoFilter==="active":app.TodoFilter==="completed"},toggleCompleted:function(){this.model.toggle()},togglePriority:function(){this.model.togglePriority()},edit:function(){this.$el.addClass("editing");this.$input.focus()},close:function(){var c=this.$input.val();var b=c.trim();if(!this.$el.hasClass("editing")){return}if(b){this.model.save({title:b});if(c!==b){this.model.trigger("change")}}else{this.clear()}this.$el.removeClass("editing")},updateOnEnter:function(b){if(b.which===ENTER_KEY){this.close()}},revertOnEscape:function(b){if(b.which===ESC_KEY){this.$el.removeClass("editing");this.$input.val(this.model.get("title"))}},clear:function(){this.model.destroy()}})})(jQuery);